% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ContrastsPlotter.R
\name{ContrastsPlotter}
\alias{ContrastsPlotter}
\title{plot contrasts}
\description{
plot contrasts

plot contrasts
}
\examples{

istar <- sim_lfq_data_peptide_config(Nprot = 100)
modelName <- "Model"
modelFunction <-
  strategy_lmer("abundance  ~ group_ + (1 | peptide_Id) + (1|sample)",
   model_name = modelName)
pepIntensity <- istar$data
config <- istar$config

mod <- build_model(
  pepIntensity,
  modelFunction,
  modelName = modelName,
  subject_Id = config$table$hierarchy_keys_depth())

 Contr <- c("group_A_vs_Ctrl" = "group_A - group_Ctrl",
 "group_B_vs_Ctrl" = "group_B - group_Ctrl"
 )
contrast <- prolfqua::Contrasts$new(mod,
  Contr)
contr <- contrast$get_contrasts()
cp <- ContrastsPlotter$new(contr,
  contrast$subject_Id,
  volcano = list(list(score = "FDR", thresh = 0.1)),
  histogram = list(list(score = "p.value", xlim = c(0,1,0.05)),
                 list(score = "FDR", xlim = c(0,1,0.05))),
  score =list(list(score = "statistic",  thresh = 5))
  )

stopifnot("plotly" \%in\% class(cp$volcano_plotly()$FDR))
stopifnot("ggplot" \%in\% class(cp$score_plot(legend=FALSE)$statistic))
p <- cp$histogram()
stopifnot("ggplot" \%in\% class(p$FDR))
stopifnot("ggplot" \%in\% class(p$p.value))
p <- cp$histogram_estimate()
stopifnot("ggplot" \%in\% class(p))
res <- cp$volcano()
stopifnot("ggplot" \%in\% class(res$FDR))
respltly <- cp$volcano_plotly()
stopifnot("plotly" \%in\% class(respltly$FDR))
stopifnot("ggplot" \%in\%  class(cp$ma_plot()))
stopifnot("plotly" \%in\%   class(cp$ma_plotly(rank=TRUE)))
res  <- cp$barplot_threshold()
stopifnot("ggplot" \%in\% class(res$FDR$plot))
stopifnot("ggplot" \%in\%  class(cp$histogram_diff()))

}
\seealso{
Other modelling: 
\code{\link{Contrasts}},
\code{\link{ContrastsMissing}},
\code{\link{ContrastsModerated}},
\code{\link{ContrastsProDA}},
\code{\link{ContrastsROPECA}},
\code{\link{ContrastsTable}},
\code{\link{INTERNAL_FUNCTIONS_BY_FAMILY}},
\code{\link{LR_test}()},
\code{\link{Model}},
\code{\link{build_model}()},
\code{\link{build_models}()},
\code{\link{contrasts_fisher_exact}()},
\code{\link{get_anova_df}()},
\code{\link{get_complete_model_fit}()},
\code{\link{get_p_values_pbeta}()},
\code{\link{isSingular_lm}()},
\code{\link{linfct_all_possible_contrasts}()},
\code{\link{linfct_factors_contrasts}()},
\code{\link{linfct_from_model}()},
\code{\link{linfct_matrix_contrasts}()},
\code{\link{make_model}()},
\code{\link{merge_contrasts_results}()},
\code{\link{model_analyse}()},
\code{\link{model_summary}()},
\code{\link{moderated_p_limma}()},
\code{\link{moderated_p_limma_long}()},
\code{\link{my_contest}()},
\code{\link{my_contrast}()},
\code{\link{my_contrast_V1}()},
\code{\link{my_contrast_V2}()},
\code{\link{my_glht}()},
\code{\link{pivot_model_contrasts_2_Wide}()},
\code{\link{plot_lmer_model_and_data}()},
\code{\link{plot_lmer_peptide_noRandom}()},
\code{\link{plot_lmer_peptide_predictions}()},
\code{\link{plot_lmer_predicted_interactions}()},
\code{\link{strategy_lmer}()},
\code{\link{summary_ROPECA_median_p.scaled}()}

Other plotting: 
\code{\link{INTERNAL_FUNCTIONS_BY_FAMILY}},
\code{\link{UpSet_interaction_missing_stats}()},
\code{\link{UpSet_missing_stats}()},
\code{\link{medpolish_estimate_df}()},
\code{\link{missigness_histogram}()},
\code{\link{missingness_per_condition}()},
\code{\link{missingness_per_condition_cumsum}()},
\code{\link{plot_NA_heatmap}()},
\code{\link{plot_estimate}()},
\code{\link{plot_heatmap}()},
\code{\link{plot_heatmap_cor}()},
\code{\link{plot_hierarchies_add_quantline}()},
\code{\link{plot_hierarchies_boxplot_df}()},
\code{\link{plot_hierarchies_line}()},
\code{\link{plot_hierarchies_line_df}()},
\code{\link{plot_intensity_distribution_violin}()},
\code{\link{plot_pca}()},
\code{\link{plot_raster}()},
\code{\link{plot_sample_correlation}()},
\code{\link{plot_screeplot}()}
}
\concept{modelling}
\concept{plotting}
\section{Public fields}{
\if{html}{\out{<div class="r6-fields">}}
\describe{
\item{\code{contrastDF}}{data frame with contrasts}

\item{\code{modelName}}{of column with model name}

\item{\code{subject_Id}}{hierarchy key columns}

\item{\code{prefix}}{default Contrasts - used to generate file names}

\item{\code{diff}}{column with fold change differences}

\item{\code{contrast}}{column with contrasts names, default "contrast"}

\item{\code{volcano_spec}}{volcano plot specification}

\item{\code{score_spec}}{score plot specification}

\item{\code{histogram_spec}}{plot specification}

\item{\code{fcthresh}}{fold change threshold}

\item{\code{avg.abundance}}{name of column containing avg abundance values.}

\item{\code{protein_annot}}{protein annotation}
}
\if{html}{\out{</div>}}
}
\section{Methods}{
\subsection{Public methods}{
\itemize{
\item \href{#method-ContrastsPlotter-new}{\code{ContrastsPlotter$new()}}
\item \href{#method-ContrastsPlotter-histogram}{\code{ContrastsPlotter$histogram()}}
\item \href{#method-ContrastsPlotter-histogram_estimate}{\code{ContrastsPlotter$histogram_estimate()}}
\item \href{#method-ContrastsPlotter-histogram_diff}{\code{ContrastsPlotter$histogram_diff()}}
\item \href{#method-ContrastsPlotter-volcano}{\code{ContrastsPlotter$volcano()}}
\item \href{#method-ContrastsPlotter-volcano_plotly}{\code{ContrastsPlotter$volcano_plotly()}}
\item \href{#method-ContrastsPlotter-ma_plot}{\code{ContrastsPlotter$ma_plot()}}
\item \href{#method-ContrastsPlotter-ma_plotly}{\code{ContrastsPlotter$ma_plotly()}}
\item \href{#method-ContrastsPlotter-score_plot}{\code{ContrastsPlotter$score_plot()}}
\item \href{#method-ContrastsPlotter-score_plotly}{\code{ContrastsPlotter$score_plotly()}}
\item \href{#method-ContrastsPlotter-barplot_threshold}{\code{ContrastsPlotter$barplot_threshold()}}
\item \href{#method-ContrastsPlotter-clone}{\code{ContrastsPlotter$clone()}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-ContrastsPlotter-new"></a>}}
\if{latex}{\out{\hypertarget{method-ContrastsPlotter-new}{}}}
\subsection{Method \code{new()}}{
create Crontrast_Plotter
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{ContrastsPlotter$new(
  contrastDF,
  subject_Id,
  volcano = list(list(score = "FDR", thresh = 0.1)),
  histogram = list(list(score = "p.value", xlim = c(0, 1, 0.05)), list(score = "FDR",
    xlim = c(0, 1, 0.05))),
  score = list(list(score = "statistic", thresh = NULL)),
  fcthresh = 1,
  modelName = "modelName",
  diff = "diff",
  contrast = "contrast",
  avg.abundance = "avgAbd",
  protein_annot = NULL
)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{contrastDF}}{frame with contrast data}

\item{\code{subject_Id}}{columns containing subject Identifier}

\item{\code{volcano}}{which score to plot and which ablines to add.}

\item{\code{histogram}}{which scores to plot and which range (x) should be shown.}

\item{\code{score}}{score parameters}

\item{\code{fcthresh}}{default 1 (log2 FC threshold)}

\item{\code{modelName}}{name of column with model names}

\item{\code{diff}}{fold change (difference) diff column}

\item{\code{contrast}}{contrast column}

\item{\code{avg.abundance}}{name of column with average abundance}

\item{\code{protein_annot}}{add protein annotation (optional)}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-ContrastsPlotter-histogram"></a>}}
\if{latex}{\out{\hypertarget{method-ContrastsPlotter-histogram}{}}}
\subsection{Method \code{histogram()}}{
plot histogram of selected scores (e.g. p-value, FDR, t-statistics)
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{ContrastsPlotter$histogram()}\if{html}{\out{</div>}}
}

}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-ContrastsPlotter-histogram_estimate"></a>}}
\if{latex}{\out{\hypertarget{method-ContrastsPlotter-histogram_estimate}{}}}
\subsection{Method \code{histogram_estimate()}}{
plot histogram of effect size - difference between groups
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{ContrastsPlotter$histogram_estimate(binwidth = 0.05)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{binwidth}}{with of bin in histogram}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-ContrastsPlotter-histogram_diff"></a>}}
\if{latex}{\out{\hypertarget{method-ContrastsPlotter-histogram_diff}{}}}
\subsection{Method \code{histogram_diff()}}{
plot histogram of differences (diff) fold change
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{ContrastsPlotter$histogram_diff(binwidth = 0.05)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{binwidth}}{with of bin in histogram}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-ContrastsPlotter-volcano"></a>}}
\if{latex}{\out{\hypertarget{method-ContrastsPlotter-volcano}{}}}
\subsection{Method \code{volcano()}}{
volcano plots (fold change vs FDR)
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{ContrastsPlotter$volcano(
  colour,
  legend = TRUE,
  scales = c("fixed", "free", "free_x", "free_y"),
  min_score = 1e-04
)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{colour}}{column name with color information default modelName}

\item{\code{legend}}{default TRUE}

\item{\code{scales}}{default fixed \code{\link{facet_wrap}}, scales argument}

\item{\code{min_score}}{replace p.values or FDR's smaller then min_score with min_score (default 0.0001).}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-ContrastsPlotter-volcano_plotly"></a>}}
\if{latex}{\out{\hypertarget{method-ContrastsPlotter-volcano_plotly}{}}}
\subsection{Method \code{volcano_plotly()}}{
plotly volcano plots
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{ContrastsPlotter$volcano_plotly(
  colour,
  legend = TRUE,
  scales = c("fixed", "free", "free_x", "free_y"),
  min_score = 1e-04
)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{colour}}{column in contrast matrix with colour coding}

\item{\code{legend}}{default TRUE}

\item{\code{scales}}{default fixed \code{\link{facet_wrap}}, scales argument}

\item{\code{min_score}}{replace p.values or FDR's smaller then min_score with min_score (default 0.0001).}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
list of ggplots
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-ContrastsPlotter-ma_plot"></a>}}
\if{latex}{\out{\hypertarget{method-ContrastsPlotter-ma_plot}{}}}
\subsection{Method \code{ma_plot()}}{
ma plot

MA plot displays the effect size estimate as a function
of the mean protein intensity across groups.
Each dot represents an observed protein.
Red horizontal lines represent the fold-change threshold.

Sometimes measured effects sizes (differences between samples groups)
are biased by the signal intensity (here protein abundance).
Such systematic effects can be explored using MA-plots.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{ContrastsPlotter$ma_plot(fc, colour, legend = TRUE, rank = TRUE)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{fc}}{fold change abline}

\item{\code{colour}}{column in contrast matrix with colour coding}

\item{\code{legend}}{enable legend default TRUE}

\item{\code{rank}}{default FALSE, if TRUE then rank of avgAbd is used.}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
ggplot
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-ContrastsPlotter-ma_plotly"></a>}}
\if{latex}{\out{\hypertarget{method-ContrastsPlotter-ma_plotly}{}}}
\subsection{Method \code{ma_plotly()}}{
ma plotly
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{ContrastsPlotter$ma_plotly(fc, colour, legend = TRUE, rank = FALSE)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{fc}}{horizontal lines}

\item{\code{colour}}{column in contrast matrix with colour coding.}

\item{\code{legend}}{enable legend default TRUE}

\item{\code{rank}}{default FALSE, if TRUE then rank of avgAbd is used.}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
list of ggplots
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-ContrastsPlotter-score_plot"></a>}}
\if{latex}{\out{\hypertarget{method-ContrastsPlotter-score_plot}{}}}
\subsection{Method \code{score_plot()}}{
plot a score against the log2 fc e.g. t-statistic
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{ContrastsPlotter$score_plot(scorespec, colour, legend = TRUE)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{scorespec}}{list(score="statistics", fcthres = 2, thresh = 5)}

\item{\code{colour}}{column with colour coding}

\item{\code{legend}}{enable legend default TRUE}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
list of ggplots
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-ContrastsPlotter-score_plotly"></a>}}
\if{latex}{\out{\hypertarget{method-ContrastsPlotter-score_plotly}{}}}
\subsection{Method \code{score_plotly()}}{
plot a score against the log2 fc e.g. t-statistic
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{ContrastsPlotter$score_plotly(scorespec, colour, legend = TRUE)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{scorespec}}{list(score="statistics", fcthres = 2, thresh = 5)}

\item{\code{colour}}{column with colour coding}

\item{\code{legend}}{enable legend default TRUE}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
list of ggplots
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-ContrastsPlotter-barplot_threshold"></a>}}
\if{latex}{\out{\hypertarget{method-ContrastsPlotter-barplot_threshold}{}}}
\subsection{Method \code{barplot_threshold()}}{
shows the number of significant proteins per contrasts
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{ContrastsPlotter$barplot_threshold()}\if{html}{\out{</div>}}
}

\subsection{Returns}{
list which contains ggplots and summary tables
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-ContrastsPlotter-clone"></a>}}
\if{latex}{\out{\hypertarget{method-ContrastsPlotter-clone}{}}}
\subsection{Method \code{clone()}}{
The objects of this class are cloneable with this method.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{ContrastsPlotter$clone(deep = FALSE)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{deep}}{Whether to make a deep clone.}
}
\if{html}{\out{</div>}}
}
}
}
