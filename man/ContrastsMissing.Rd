% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ContrastsSimpleImpute.R
\name{ContrastsMissing}
\alias{ContrastsMissing}
\title{Compute contrasts with group mean imputation}
\description{
Compute contrasts with group mean imputation

Compute contrasts with group mean imputation
}
\details{
If there are no observations in one of the groups for some of the proteins,
the group mean cannot be estimated. Therefore, assuming that the observation
is missing because the protein abundance is below the detection limit,
we substitute the unobserved group with the median of protein abundances
 observed only in one sample of the group.
The variance of a protein is estimated using the pooled variance
of all observations of all groups.
}
\examples{
Nprot <- 120
istar <- prolfqua::sim_lfq_data_protein_config(Nprot = Nprot,weight_missing = .4)
istar$data$abundance |> is.na() |> sum()
protIntensity <- istar$data
config <- istar$config


lProt <- LFQData$new(protIntensity, config)
lProt$rename_response("transformedIntensity")

Contr <- c("dil.b_vs_a" = "group_A - group_Ctrl")
csi <- ContrastsMissing$new(lProt, contrasts = Contr)
csi$get_contrast_sides()

res <- csi$get_contrasts()

stopifnot(nrow(res) ==  (protIntensity$protein_Id |> unique() |> length()))
res$contrast |> table()
stopifnot((res$p.value |> is.na() |> sum()) == 0)
plot(res$diff, -log10(res$p.value), pch = ".")
csi$column_description()
x<- csi$get_Plotter()
p <- x$volcano()
pdf(file = NULL)
print(p)
dev.off()

dd <- prolfqua::sim_lfq_data_protein_2Factor_config(Nprot = 100,weight_missing = 0.1)

Contrasts <- c("c1" = "TreatmentA - TreatmentB",
               "C2" = "BackgroundX- BackgroundZ",
               "c3" = "`TreatmentA:BackgroundX` - `TreatmentA:BackgroundZ`",
               "c4" = "`TreatmentB:BackgroundX` - `TreatmentB:BackgroundZ`"
               )
lProt <- LFQData$new(dd$data, dd$config)
lProt$rename_response("transformedIntensity")

csi <- ContrastsMissing$new(lProt, contrasts = Contrasts)
res <- csi$get_contrasts()
pl <- csi$get_Plotter()
pdf(file = NULL)
pl$volcano()
dev.off()
}
\seealso{
Other modelling: 
\code{\link{Contrasts}},
\code{\link{ContrastsModerated}},
\code{\link{ContrastsPlotter}},
\code{\link{ContrastsProDA}},
\code{\link{ContrastsROPECA}},
\code{\link{ContrastsTable}},
\code{\link{INTERNAL_FUNCTIONS_BY_FAMILY}},
\code{\link{LR_test}()},
\code{\link{Model}},
\code{\link{build_model}()},
\code{\link{build_models}()},
\code{\link{contrasts_fisher_exact}()},
\code{\link{get_anova_df}()},
\code{\link{get_complete_model_fit}()},
\code{\link{get_imputed_contrasts}()},
\code{\link{get_p_values_pbeta}()},
\code{\link{isSingular_lm}()},
\code{\link{linfct_all_possible_contrasts}()},
\code{\link{linfct_factors_contrasts}()},
\code{\link{linfct_from_model}()},
\code{\link{linfct_matrix_contrasts}()},
\code{\link{make_model}()},
\code{\link{merge_contrasts_results}()},
\code{\link{model_analyse}()},
\code{\link{model_summary}()},
\code{\link{moderated_p_limma}()},
\code{\link{moderated_p_limma_long}()},
\code{\link{my_contest}()},
\code{\link{my_contrast}()},
\code{\link{my_contrast_V1}()},
\code{\link{my_contrast_V2}()},
\code{\link{my_glht}()},
\code{\link{pivot_model_contrasts_2_Wide}()},
\code{\link{plot_lmer_model_and_data}()},
\code{\link{plot_lmer_peptide_noRandom}()},
\code{\link{plot_lmer_peptide_predictions}()},
\code{\link{plot_lmer_predicted_interactions}()},
\code{\link{strategy_lmer}()},
\code{\link{summary_ROPECA_median_p.scaled}()}
}
\concept{modelling}
\section{Super class}{
\code{\link[prolfqua:ContrastsInterface]{prolfqua::ContrastsInterface}} -> \code{ContrastsMissing}
}
\section{Public fields}{
\if{html}{\out{<div class="r6-fields">}}
\describe{
\item{\code{subject_Id}}{subject_id e.g. protein_ID column}

\item{\code{contrasts}}{array with contrasts (see example)}

\item{\code{modelName}}{model name}

\item{\code{contrast_result}}{data frame with results of contrast computation}

\item{\code{lfqdata}}{data frame}

\item{\code{confint}}{confidence interval}

\item{\code{p.adjust}}{function to adjust p-values}

\item{\code{global}}{Take global or local values for imputation}

\item{\code{present}}{default 1, presence in interaction to infer limit of detection.}

\item{\code{minsd}}{default 1, if standard deviation can not be estimated, what is the prior minimum sd, default = 1s}
}
\if{html}{\out{</div>}}
}
\section{Methods}{
\subsection{Public methods}{
\itemize{
\item \href{#method-ContrastsMissing-new}{\code{ContrastsMissing$new()}}
\item \href{#method-ContrastsMissing-get_contrast_sides}{\code{ContrastsMissing$get_contrast_sides()}}
\item \href{#method-ContrastsMissing-get_contrasts}{\code{ContrastsMissing$get_contrasts()}}
\item \href{#method-ContrastsMissing-get_Plotter}{\code{ContrastsMissing$get_Plotter()}}
\item \href{#method-ContrastsMissing-to_wide}{\code{ContrastsMissing$to_wide()}}
\item \href{#method-ContrastsMissing-clone}{\code{ContrastsMissing$clone()}}
}
}
\if{html}{\out{
<details open><summary>Inherited methods</summary>
<ul>
<li><span class="pkg-link" data-pkg="prolfqua" data-topic="ContrastsInterface" data-id="column_description"><a href='../../prolfqua/html/ContrastsInterface.html#method-ContrastsInterface-column_description'><code>prolfqua::ContrastsInterface$column_description()</code></a></span></li>
</ul>
</details>
}}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-ContrastsMissing-new"></a>}}
\if{latex}{\out{\hypertarget{method-ContrastsMissing-new}{}}}
\subsection{Method \code{new()}}{
initialize
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{ContrastsMissing$new(
  lfqdata,
  contrasts,
  confint = 0.95,
  p.adjust = prolfqua::adjust_p_values,
  modelName = "groupAverage"
)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{lfqdata}}{LFQData}

\item{\code{contrasts}}{array of contrasts (see example)}

\item{\code{confint}}{confidence interval}

\item{\code{p.adjust}}{method for p-value adjustment - default Benjamini Hochberg}

\item{\code{modelName}}{default "groupAverage"}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-ContrastsMissing-get_contrast_sides"></a>}}
\if{latex}{\out{\hypertarget{method-ContrastsMissing-get_contrast_sides}{}}}
\subsection{Method \code{get_contrast_sides()}}{
get contrasts sides
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{ContrastsMissing$get_contrast_sides()}\if{html}{\out{</div>}}
}

}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-ContrastsMissing-get_contrasts"></a>}}
\if{latex}{\out{\hypertarget{method-ContrastsMissing-get_contrasts}{}}}
\subsection{Method \code{get_contrasts()}}{
table with results of contrast computation
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{ContrastsMissing$get_contrasts(all = FALSE)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{all}}{FALSE, do not show all columns (default)}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-ContrastsMissing-get_Plotter"></a>}}
\if{latex}{\out{\hypertarget{method-ContrastsMissing-get_Plotter}{}}}
\subsection{Method \code{get_Plotter()}}{
get ContrastsPlotter
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{ContrastsMissing$get_Plotter()}\if{html}{\out{</div>}}
}

\subsection{Returns}{
Contrast_Plotter
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-ContrastsMissing-to_wide"></a>}}
\if{latex}{\out{\hypertarget{method-ContrastsMissing-to_wide}{}}}
\subsection{Method \code{to_wide()}}{
convert contrast results to wide format
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{ContrastsMissing$to_wide(columns = c("p.value", "FDR"))}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{columns}}{value column default p.value}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
data.frame
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-ContrastsMissing-clone"></a>}}
\if{latex}{\out{\hypertarget{method-ContrastsMissing-clone}{}}}
\subsection{Method \code{clone()}}{
The objects of this class are cloneable with this method.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{ContrastsMissing$clone(deep = FALSE)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{deep}}{Whether to make a deep clone.}
}
\if{html}{\out{</div>}}
}
}
}
