% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/tidyMS_missigness.R
\name{.missigness_impute_interactions}
\alias{.missigness_impute_interactions}
\title{Compute interaction averages and
impute data using mean of lowest 0.1 (default)}
\usage{
.missigness_impute_interactions(
  pdata,
  config,
  factors = config$table$factor_keys_depth(),
  probs = 0.1,
  global = TRUE
)
}
\arguments{
\item{pdata}{data.frame}

\item{config}{AnalysisConfiguration}

\item{factors}{factor to include (default up to factor depth)}

\item{probs}{quantile to take average from (default 0.1)}

\item{global}{global min value}
}
\value{
function with parameter `value`
`c("long", "nrReplicates", "nrMeasured", "meanArea", "imputed", "allWide", "all")`

function
}
\description{
used in Acetylation project p2916
}
\examples{

bb <- prolfqua_data("data_ionstar")$filtered()
stopifnot(nrow(bb$data) == 25780)
configur <- old2new(bb$config)
data <- bb$data
configur$parameter$qVal_individual_threshold <- 0.01

xx <- prolfqua::remove_large_QValues(data, configur)
xx <- complete_cases(xx, configur)
nrPepTimesDilution <- length(unique(paste0(xx$protein_Id, xx$peptide_Id))) *
  length(unique(xx$dilution.))
tmp <- interaction_missing_stats(xx, configur)
stopifnot(nrow(tmp$data) == nrPepTimesDilution)
fun <- .missigness_impute_interactions(xx, configur)

long <- fun("long")
nrow(long) == nrPepTimesDilution
alldata <- fun("all")
stopifnot(length(names(alldata)) == 5)

imputed <- fun("imputed")
stopifnot(nrow(imputed) == length(unique(paste0(xx$protein_Id, xx$peptide_Id))))
missing <- fun("nrMeasured")
stopifnot(nrow(missing) == length(unique(paste0(xx$protein_Id, xx$peptide_Id))))

meanArea <- fun("mean")
stopifnot(nrow(meanArea) == length(unique(paste0(xx$protein_Id, xx$peptide_Id))))
print(sum(is.na(meanArea$mean.dilution.a)))
stopifnot(sum(is.na(imputed$mean.imp.dilution.a)) == 0)

}
\keyword{internal}
