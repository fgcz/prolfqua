% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/tidyMS_R6_Modelling.R
\name{summary_ROPECA_median_p.scaled}
\alias{summary_ROPECA_median_p.scaled}
\title{compute protein level fold changes and p.values (using beta distribution)
takes p-value of the scaled p-value}
\usage{
summary_ROPECA_median_p.scaled(
  contrasts_data,
  contrast = "contrast",
  subject_Id = "protein_Id",
  estimate = "diff",
  statistic = "statistic",
  p.value = "moderated.p.value",
  max.n = 10
)
}
\arguments{
\item{contrasts_data}{data frame}

\item{contrast}{name of column with contrast identifier}

\item{subject_Id}{name of column with typically protein Id}

\item{estimate}{name of column with effect size estimate}

\item{statistic}{statistic name of column with statistic (typically t-statistics)}

\item{p.value}{name of column with moderated.p.value}

\item{max.n}{used to limit the number of peptides in probablity computation.}
}
\value{
data.frame with columns
}
\description{
compute protein level fold changes and p.values (using beta distribution)
takes p-value of the scaled p-value
}
\examples{

set.seed(10)
nrPep <- 10000
nrProtein <- 800
p.value <- runif(nrPep)
estimate <- rnorm(nrPep)
avgAbd <- runif(nrPep)
protein_Id <- sample(1:800, size = nrPep,
  replace = TRUE, prob = dexp(seq(0,5,length = 800)))

plot(table(table(protein_Id)))

testdata <- data.frame(contrast = "contrast1",
  protein_Id = protein_Id,
  estimate = estimate,
  pseudo_estimate = estimate,
  p.value = p.value,
  avgAbd = avgAbd )

xx30 <- summary_ROPECA_median_p.scaled(testdata,
                                    subject_Id = "protein_Id",
                                    estimate = "estimate",
                                    p.value = "p.value",
                                    max.n = 30)

xx2 <- summary_ROPECA_median_p.scaled(testdata,
                                    subject_Id = "protein_Id",
                                    estimate = "estimate",
                                    p.value = "p.value",
                                    max.n = 1)

testthat::expect_equal(mad(xx2$estimate, na.rm = TRUE),0.384409, tolerance = 1e-4)
testthat::expect_equal(median(xx2$estimate), -0.006874857, tolerance = 1e-4)
testthat::expect_equal(xx2$beta.based.significance[1],0.819, tolerance = 1e-3)
testthat::expect_equal(xx2$beta.based.significance[2],0.9234362,tolerance = 1e-3)

# Uniform distribution
hist(testdata$p.value)
hist(xx30$median.p.scaled, breaks = 20)
hist(xx2$median.p.scaled, breaks = 20)
# shows that beta.based.significance has NO uniform distribution
# although H0 is true for all cases.

hist(xx30$beta.based.significance, breaks = 20)
hist(xx2$beta.based.significance, breaks = 20)

hist(xx2$median.p.value, breaks = 20)
hist(xx2$beta.based.significance, breaks = 20)
hist(estimate)

}
\seealso{
Other modelling: 
\code{\link{Contrasts}},
\code{\link{ContrastsMissing}},
\code{\link{ContrastsModerated}},
\code{\link{ContrastsPlotter}},
\code{\link{ContrastsProDA}},
\code{\link{ContrastsROPECA}},
\code{\link{ContrastsTable}},
\code{\link{INTERNAL_FUNCTIONS_BY_FAMILY}},
\code{\link{LR_test}()},
\code{\link{Model}},
\code{\link{build_model}()},
\code{\link{contrasts_fisher_exact}()},
\code{\link{get_anova_df}()},
\code{\link{get_complete_model_fit}()},
\code{\link{get_p_values_pbeta}()},
\code{\link{isSingular_lm}()},
\code{\link{linfct_all_possible_contrasts}()},
\code{\link{linfct_factors_contrasts}()},
\code{\link{linfct_from_model}()},
\code{\link{linfct_matrix_contrasts}()},
\code{\link{merge_contrasts_results}()},
\code{\link{model_analyse}()},
\code{\link{model_summary}()},
\code{\link{moderated_p_limma}()},
\code{\link{moderated_p_limma_long}()},
\code{\link{my_contest}()},
\code{\link{my_contrast}()},
\code{\link{my_contrast_V1}()},
\code{\link{my_contrast_V2}()},
\code{\link{my_glht}()},
\code{\link{pivot_model_contrasts_2_Wide}()},
\code{\link{plot_lmer_peptide_predictions}()},
\code{\link{sim_build_models_lm}()},
\code{\link{sim_build_models_lmer}()},
\code{\link{sim_make_model_lm}()},
\code{\link{sim_make_model_lmer}()},
\code{\link{strategy_lmer}()}
}
\concept{modelling}
\keyword{internal}
