% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/tidyMS_plotting.R
\name{plot_hierarchies_boxplot}
\alias{plot_hierarchies_boxplot}
\title{plot peptides by factors and it's levels.}
\usage{
plot_hierarchies_boxplot(
  pdata,
  title,
  config,
  facet_grid_on = NULL,
  beeswarm = TRUE,
  pb
)
}
\arguments{
\item{pdata}{data.frame}

\item{title}{name to show}

\item{config}{AnalysisConfiguration}

\item{facet_grid_on}{on which variable to run facet_grid}

\item{beeswarm}{use beeswarm default FALSE}
}
\description{
plot peptides by factors and it's levels.
}
\examples{


istar <- prolfqua_data('data_ionstar')$filtered()
stopifnot(nrow(istar$data) == 25780)
conf <- istar$config$clone(deep=TRUE)
analysis <- istar$data
conf$table$hierarchyDepth
conf$table$hkeysDepth()

xnested <- analysis |>
 dplyr::group_by_at(conf$table$hkeysDepth()) |> tidyr::nest()

#debug(plot_hierarchies_boxplot)
p <- plot_hierarchies_boxplot(xnested$data[[3]],
 xnested$protein_Id[[3]],
  conf,
  facet_grid_on =  tail(conf$table$hierarchyKeys(),1))
stopifnot("ggplot" \%in\% class(p))

p <- plot_hierarchies_boxplot(xnested$data[[3]],
 xnested$protein_Id[[3]],
  conf )
stopifnot("ggplot" \%in\% class(p))

p <- plot_hierarchies_boxplot(
 xnested$data[[3]],
 xnested$protein_Id[[3]],
  conf,
   beeswarm = FALSE )
stopifnot("ggplot" \%in\% class(p))

bb <- prolfqua_data('data_skylineSRM_HL_A')
config <- bb$config_f()
analysis <- bb$analysis(bb$data, config)
data <- prolfqua::transform_work_intensity(analysis, config, log2)
res <- plot_hierarchies_boxplot_df(data, config)
res$boxplot[[1]]

hierarchy = config$table$hkeysDepth()
xnested <- data |> dplyr::group_by_at(hierarchy) |> tidyr::nest()
p <- plot_hierarchies_boxplot(xnested$data[[1]], xnested$protein_Id[[1]],config, beeswarm = FALSE)
p
p <- plot_hierarchies_boxplot(xnested$data[[1]], xnested$protein_Id[[1]],config, beeswarm = TRUE)
p
p <- plot_hierarchies_boxplot(xnested$data[[1]], xnested$protein_Id[[1]],config, beeswarm = TRUE, facet_grid_on = "precursor_Id")
p

}
\keyword{internal}
