% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/tidyMS_missigness.R
\name{aggregate_contrast}
\alias{aggregate_contrast}
\title{Compute fold changes given Contrasts}
\usage{
aggregate_contrast(
  data,
  subject_Id,
  agg_func = list(median = function(x) {
     stats::median(x, na.rm = TRUE)
 }, mad =
    function(x) {
     stats::mad(x, na.rm = TRUE)
 }),
  contrast = "contrast"
)
}
\description{
Compute fold changes given Contrasts
}
\examples{


bb <- prolfqua_data('data_ionstar')$normalized()

configur <- old2new(bb$config)
data <- bb$data

Contrasts <- c("dilution.b-a" = "dilution.b - dilution.a", "dilution.c-e" = "dilution.c - dilution.e")
mean <- missigness_impute_factors_interactions(data, configur, value = "meanAbundance" )
mean <- get_contrast(mean, configur$table$hierarchy_keys(), Contrasts)
meanProt <- aggregate_contrast(mean,  subject_Id =  configur$table$hierarchy_keys_depth())

imputed <- missigness_impute_factors_interactions(data, configur, value = "imputed" )
imputed <- get_contrast(imputed, configur$table$hierarchy_keys(), Contrasts)

imputedProt <- aggregate_contrast(imputed,  subject_Id =  configur$table$hierarchy_keys_depth())
plot(imputedProt$group_1 - imputedProt$group_2, imputedProt$estimate_median)
abline(c(0,1), col=2, pch = "*")
dim(meanProt)
sum(is.na(meanProt$estimate_median)) == 0
sum(is.na(imputedProt$estimate_median)) == 0
plot(meanProt$estimate_median - imputedProt$estimate_median )

}
\seealso{
Other imputation: 
\code{\link{UpSet_interaction_missing_stats}()},
\code{\link{UpSet_missing_stats}()},
\code{\link{get_contrast}()},
\code{\link{missigness_histogram}()},
\code{\link{missigness_impute_factors_interactions}()},
\code{\link{missingness_per_condition_cumsum}()},
\code{\link{missingness_per_condition}()}
}
\concept{imputation}
\keyword{internal}
