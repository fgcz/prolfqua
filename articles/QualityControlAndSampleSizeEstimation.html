<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>QC and Sample Size Estimation • prolfqua</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="QC and Sample Size Estimation">
<meta property="og:description" content="prolfqua">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">prolfqua</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.2.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Comparing2Groups.html">Comparing Two Groups with prolfqua</a>
    </li>
    <li>
      <a href="../articles/CreatingConfigurations.html">Creating prolfqua Configurations</a>
    </li>
    <li>
      <a href="../articles/Modelling2Factors.html">Modelling dataset with two Factors</a>
    </li>
    <li>
      <a href="../articles/QCandSampleSize.html">Quality Control &amp; Sample Size Estimation</a>
    </li>
    <li>
      <a href="../articles/QualityControlAndSampleSizeEstimation.html">QC and Sample Size Estimation</a>
    </li>
    <li>
      <a href="../articles/SimulateData.html">Simulate Peptide level Data</a>
    </li>
    <li>
      <a href="../articles/TestingMissingInference.html">Impute</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/wolski/prolfqua/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>QC and Sample Size Estimation</h1>
                        <h4 data-toc-skip class="author">Witold E.
Wolski</h4>
            
            <h4 data-toc-skip class="date">2024-05-30</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/wolski/prolfqua/blob/HEAD/vignettes/QualityControlAndSampleSizeEstimation.Rmd" class="external-link"><code>vignettes/QualityControlAndSampleSizeEstimation.Rmd</code></a></small>
      <div class="hidden name"><code>QualityControlAndSampleSizeEstimation.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="purpose">Purpose<a class="anchor" aria-label="anchor" href="#purpose"></a>
</h2>
<p>This vignette demonstrates how the package can be used to create
descriptive statistics or quality control plots for a dataset. First, we
read a “proteinGroups.txt” file from the MaxQuant software, and next, we
specify a prolfqua configuration. Afterward, the data is transformed and
normalized, and plots describing the data are generated. Finally, we
estimate how many samples are necessary to properly quantify a two-fold
change for <span class="math inline">\(90%\)</span> of all the proteins
with a power of <span class="math inline">\(0.8\)</span>.</p>
</div>
<div class="section level2">
<h2 id="loading-data">Loading data<a class="anchor" aria-label="anchor" href="#loading-data"></a>
</h2>
<p>Generate Simulated data. To learn how to create prolfqua LFQData
objects see the vignette: creating configurations.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simdata</span> <span class="op">&lt;-</span> <span class="fu">prolfqua</span><span class="fu">::</span><span class="fu"><a href="../reference/sim_lfq_data_peptide_config.html">sim_lfq_data_peptide_config</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">lfqdata</span> <span class="op">&lt;-</span> <span class="fu">prolfqua</span><span class="fu">::</span><span class="va"><a href="../reference/LFQData.html">LFQData</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">simdata</span><span class="op">$</span><span class="va">data</span>,<span class="va">simdata</span><span class="op">$</span><span class="va">config</span><span class="op">)</span></span>
<span><span class="va">lfqdata</span><span class="op">$</span><span class="fu">remove_small_intensities</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>You can convert the data into a data frame in a wide format, where
the intensities of each sample occupy their columns.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lfqdata</span><span class="op">$</span><span class="fu">to_wide</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">data</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 3 × 8</span></span></span>
<span><span class="co">##   protein_Id  peptide_Id isotopeLabel  A_V1  A_V2  A_V3  A_V4  B_V1</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> 0EfVhX~0087 ahQLlQY7   light         26.9  25.2  26.1  25.2  26.1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> 0EfVhX~0087 dJkdz7so   light         <span style="color: #BB0000;">NA</span>    16.1  14.7  <span style="color: #BB0000;">NA</span>    25.7</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> 0EfVhX~0087 ITLb4x1q   light         19.4  <span style="color: #BB0000;">NA</span>    18.2  18.9  28.9</span></span></code></pre>
<div class="section level3">
<h3 id="visualization-of-not-normalized-data">Visualization of not normalized data<a class="anchor" aria-label="anchor" href="#visualization-of-not-normalized-data"></a>
</h3>
<p>Next we show how the data is distributed before transformation and
normalization.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lfqplotter</span> <span class="op">&lt;-</span> <span class="va">lfqdata</span><span class="op">$</span><span class="fu">get_Plotter</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">lfqplotter</span><span class="op">$</span><span class="fu">intensity_distribution_density</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="QualityControlAndSampleSizeEstimation_files/figure-html/intensityDistribution-1.png" width="700"></p>
<div class="section level4">
<h4 id="visualization-of-missing-data">Visualization of missing data<a class="anchor" aria-label="anchor" href="#visualization-of-missing-data"></a>
</h4>
<p>Often it also makes sense to look into the part of the data that is
not quantified in all samples. Therefore several functions for the
missingess are available. In the <code>NA_heatmap</code> function it is
possible to see if some missing proteins are specific for one particular
dilution or if they appear randomly in all samples.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nah</span> <span class="op">&lt;-</span> <span class="va">lfqplotter</span><span class="op">$</span><span class="fu">NA_heatmap</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Prints missing heatmap:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nah</span></span></code></pre></div>
<div class="figure">
<img src="QualityControlAndSampleSizeEstimation_files/figure-html/printMissingHeatmap-1.png" alt="Heatmap, black - missing protein intensities, white - present" width="700"><p class="caption">
Heatmap, black - missing protein intensities, white - present
</p>
</div>
<p>Also in the next two figures we show how many missing values are
found in the respective conditions and how many proteins do not have
missing data and how complete the measurements are for each group.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lfqdata</span><span class="op">$</span><span class="fu">get_Summariser</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">plot_missingness_per_group</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="QualityControlAndSampleSizeEstimation_files/figure-html/summaryPerGroup-1.png" alt="# of proteins with 0,1,...N missing values" width="700"><p class="caption">
# of proteins with 0,1,…N missing values
</p>
</div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lfqdata</span><span class="op">$</span><span class="fu">get_Summariser</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">plot_missingness_per_group_cumsum</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="QualityControlAndSampleSizeEstimation_files/figure-html/cumSumSummary-1.png" alt="Cumulative sum of the # of proteins with 0,1,...N missing values" width="700"><p class="caption">
Cumulative sum of the # of proteins with 0,1,…N missing values
</p>
</div>
<p>In the <code>missigness_histogram</code> we can check if there is a
dependency between NAs (and the number of NAs for earch protein) with
respect to the protein intensity.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lfqplotter</span><span class="op">$</span><span class="fu">missigness_histogram</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="QualityControlAndSampleSizeEstimation_files/figure-html/missingnessHist-1.png" alt="Intensity distribution of proteins depending on # of missing values" width="700"><p class="caption">
Intensity distribution of proteins depending on # of missing values
</p>
</div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="computing-standard-deviations-mean-and-cv-">Computing standard deviations, mean and CV.<a class="anchor" aria-label="anchor" href="#computing-standard-deviations-mean-and-cv-"></a>
</h2>
<p>Other important statistics that can be easily calculated from the
object are coefficient of variation, means and standard deviations.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stats</span> <span class="op">&lt;-</span> <span class="va">lfqdata</span><span class="op">$</span><span class="fu">get_Stats</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "group_"</span></span>
<span><span class="co">## NULL</span></span></code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">prolfqua</span><span class="fu">::</span><span class="fu"><a href="../reference/table_facade.html">table_facade</a></span><span class="op">(</span> <span class="va">stats</span><span class="op">$</span><span class="fu">stats_quantiles</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">wide</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"quantile of "</span>,<span class="va">stats</span><span class="op">$</span><span class="va">stat</span> <span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>quantile of CV</caption>
<thead><tr class="header">
<th align="right">probs</th>
<th align="right">A</th>
<th align="right">All</th>
<th align="right">B</th>
<th align="right">Ctrl</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">0.10</td>
<td align="right">1.215060</td>
<td align="right">7.185163</td>
<td align="right">1.236542</td>
<td align="right">1.129780</td>
</tr>
<tr class="even">
<td align="right">0.25</td>
<td align="right">2.442726</td>
<td align="right">12.277918</td>
<td align="right">1.999453</td>
<td align="right">1.607515</td>
</tr>
<tr class="odd">
<td align="right">0.50</td>
<td align="right">3.418211</td>
<td align="right">15.169313</td>
<td align="right">3.026062</td>
<td align="right">3.349758</td>
</tr>
<tr class="even">
<td align="right">0.75</td>
<td align="right">4.599101</td>
<td align="right">19.467593</td>
<td align="right">4.155821</td>
<td align="right">4.885600</td>
</tr>
<tr class="odd">
<td align="right">0.90</td>
<td align="right">6.349093</td>
<td align="right">21.451325</td>
<td align="right">5.322302</td>
<td align="right">6.008022</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stats</span><span class="op">$</span><span class="fu">density_median</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="QualityControlAndSampleSizeEstimation_files/figure-html/cvDistr-1.png" alt="Distribution of CV's" width="700"><p class="caption">
Distribution of CV’s
</p>
</div>
<p>In the next figure we show the dependency of the standard deviation
with respect to the mean intensitiy of the proteins.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stdm_raw</span> <span class="op">&lt;-</span> <span class="va">stats</span><span class="op">$</span><span class="fu">stdv_vs_mean</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_log10</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_log10</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">stdm_raw</span></span></code></pre></div>
<div class="figure">
<img src="QualityControlAndSampleSizeEstimation_files/figure-html/stdvVSmean-1.png" alt="Scatter plot of standard deviation vs mean" width="700"><p class="caption">
Scatter plot of standard deviation vs mean
</p>
</div>
<div class="section level3">
<h3 id="normalize-protein-intensities">Normalize protein intensities<a class="anchor" aria-label="anchor" href="#normalize-protein-intensities"></a>
</h3>
<p>Next, we want to normalize the data by first <span class="math inline">\(\log_2\)</span> transforming it and then
z-scaling. The <span class="math inline">\(log_2\)</span> stabilizes the
variance, while the z-scaling removes systematic differences from the
samples.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lt</span> <span class="op">&lt;-</span> <span class="va">lfqdata</span><span class="op">$</span><span class="fu">get_Transformer</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">transformed</span> <span class="op">&lt;-</span> <span class="va">lt</span><span class="op">$</span><span class="fu">log2</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">robscale</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">lfq</span></span>
<span><span class="va">transformed</span><span class="op">$</span><span class="va">config</span><span class="op">$</span><span class="va">table</span><span class="op">$</span><span class="va">is_response_transformed</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<p>Again we want to look into the distribution of the intensities in our
samples after normalization.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pl</span> <span class="op">&lt;-</span> <span class="va">transformed</span><span class="op">$</span><span class="fu">get_Plotter</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">pl</span><span class="op">$</span><span class="fu">intensity_distribution_density</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="QualityControlAndSampleSizeEstimation_files/figure-html/plotDensities-1.png" alt="Normalized intensities." width="700"><p class="caption">
Normalized intensities.
</p>
</div>
<p>plots matrix scatter plot in the upper right matrix and some
statistics in the lower left matrix.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pl</span><span class="op">$</span><span class="fu">pairs_smooth</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="QualityControlAndSampleSizeEstimation_files/figure-html/plotScatterMatrix-1.png" alt="Scatterplot matrix" width="700"><p class="caption">
Scatterplot matrix
</p>
</div>
<pre><code><span><span class="co">## NULL</span></span></code></pre>
<p>plots protein heatmap:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">pl</span><span class="op">$</span><span class="fu">heatmap</span><span class="op">(</span><span class="op">)</span> </span>
<span><span class="va">p</span> </span></code></pre></div>
<div class="figure" style="text-align: 5">
<img src="QualityControlAndSampleSizeEstimation_files/figure-html/plotheatmap-1.png" alt="Heatmap, Rows - proteins, Columns - samples" width="700"><p class="caption">
Heatmap, Rows - proteins, Columns - samples
</p>
</div>
<p>We can also look at the correlation among the samples or look at a
PCA plot.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hc</span> <span class="op">&lt;-</span> <span class="va">pl</span><span class="op">$</span><span class="fu">heatmap_cor</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hc</span></span></code></pre></div>
<div class="figure" style="text-align: 5">
<img src="QualityControlAndSampleSizeEstimation_files/figure-html/plotHeatmapCor-1.png" alt="Heatmap based on sample correlations, Rows - samples, Columns - samples" width="700"><p class="caption">
Heatmap based on sample correlations, Rows - samples, Columns - samples
</p>
</div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pl</span><span class="op">$</span><span class="fu">pca</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: 5">
<img src="QualityControlAndSampleSizeEstimation_files/figure-html/doPCA-1.png" alt="Principal component analysis for all samples" width="700"><p class="caption">
Principal component analysis for all samples
</p>
</div>
<p>prints the standard deviations:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stats</span> <span class="op">&lt;-</span> <span class="va">transformed</span><span class="op">$</span><span class="fu">get_Stats</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "group_"</span></span>
<span><span class="co">## NULL</span></span></code></pre>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">prolfqua</span><span class="fu">::</span><span class="fu"><a href="../reference/table_facade.html">table_facade</a></span><span class="op">(</span><span class="va">stats</span><span class="op">$</span><span class="fu">stats_quantiles</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">wide</span>, <span class="st">"Standard deviations"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Standard deviations</caption>
<thead><tr class="header">
<th align="right">probs</th>
<th align="right">A</th>
<th align="right">All</th>
<th align="right">B</th>
<th align="right">Ctrl</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">0.10</td>
<td align="right">0.0355196</td>
<td align="right">0.1152932</td>
<td align="right">0.0325012</td>
<td align="right">0.0294799</td>
</tr>
<tr class="even">
<td align="right">0.25</td>
<td align="right">0.0587524</td>
<td align="right">0.1677154</td>
<td align="right">0.0582281</td>
<td align="right">0.0422670</td>
</tr>
<tr class="odd">
<td align="right">0.50</td>
<td align="right">0.0717438</td>
<td align="right">0.2345489</td>
<td align="right">0.0853025</td>
<td align="right">0.0566645</td>
</tr>
<tr class="even">
<td align="right">0.75</td>
<td align="right">0.1240478</td>
<td align="right">0.3004859</td>
<td align="right">0.1209993</td>
<td align="right">0.0720238</td>
</tr>
<tr class="odd">
<td align="right">0.90</td>
<td align="right">0.1687990</td>
<td align="right">0.3253740</td>
<td align="right">0.1388753</td>
<td align="right">0.1087199</td>
</tr>
</tbody>
</table>
<p>plots density of the standard deviation</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stats</span><span class="op">$</span><span class="fu">density_median</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="QualityControlAndSampleSizeEstimation_files/figure-html/sddensity-1.png" alt="Density of the standard deviation" width="700"><p class="caption">
Density of the standard deviation
</p>
</div>
<p>Check for heteroskedasticity. After transformation, the standard
deviation should be independent of the mean intensity.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stdm_trans</span> <span class="op">&lt;-</span> <span class="va">stats</span><span class="op">$</span><span class="fu">stdv_vs_mean</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_log10</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_log10</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">stdm_trans</span></span></code></pre></div>
<div class="figure">
<img src="QualityControlAndSampleSizeEstimation_files/figure-html/checkForHeteroskedasticity-1.png" alt="Scatter plot of sd vs mean of protein intensity" width="700"><p class="caption">
Scatter plot of sd vs mean of protein intensity
</p>
</div>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#gridExtra::grid.arrange(stdm_raw, stdm_trans, nrow=1)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="estimate-sample-size">Estimate sample size<a class="anchor" aria-label="anchor" href="#estimate-sample-size"></a>
</h3>
<p>For the sample size estimation we will now focus on only one
condition and the different bio-reps from the <em>a</em> group In this
condition all samples have the same concentration and we want to check
variability within this group. Like this we can estimate how many
samples are necessary per group to quantify properly a two-fold change
(delta of 1) for 90% of all the proteins with a power of 0.8 and
significance level of 0.05.</p>
<p>First, we need to filter our data for <code>group_</code> <em>A</em>
only.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">transformedA</span> <span class="op">&lt;-</span> <span class="va">transformed</span><span class="op">$</span><span class="fu">get_copy</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">transformedA</span><span class="op">$</span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">transformedA</span><span class="op">$</span><span class="va">data</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">group_</span>  <span class="op">==</span> <span class="st">"A"</span><span class="op">)</span></span>
<span><span class="va">stats</span> <span class="op">&lt;-</span> <span class="va">transformedA</span><span class="op">$</span><span class="fu">get_Stats</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "group_"</span></span>
<span><span class="co">## NULL</span></span></code></pre>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stats</span><span class="op">$</span><span class="fu">density</span><span class="op">(</span>ggstat <span class="op">=</span> <span class="st">"ecdf"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="QualityControlAndSampleSizeEstimation_files/figure-html/unnamed-chunk-2-1.png" alt="Empirical cumulative density function of the standard deviation for all the proteins in the dataset." width="700"><p class="caption">
Empirical cumulative density function of the standard deviation for all
the proteins in the dataset.
</p>
</div>
<p>The table indicates that for this kind of data - if a two-fold change
for 90% of all the proteins should be accurately quantified with a power
of 0.8 (at 0.05 significance level) one would need to have 10 samples in
each group.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sampleSize</span> <span class="op">&lt;-</span> <span class="va">stats</span><span class="op">$</span><span class="fu">power_t_test_quantiles</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">group_</span> <span class="op">!=</span> <span class="st">"All"</span><span class="op">)</span></span>
<span><span class="fu">prolfqua</span><span class="fu">::</span><span class="fu"><a href="../reference/table_facade.html">table_facade</a></span><span class="op">(</span><span class="va">sampleSize</span>, <span class="st">"Sample sizes. delta - Effect size, N - samplesize"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Sample sizes. delta - Effect size, N - samplesize</caption>
<thead><tr class="header">
<th align="left">group_</th>
<th align="right">probs</th>
<th align="right">quantiles</th>
<th align="right">sdtrimmed</th>
<th align="right">N_exact</th>
<th align="right">N</th>
<th align="right">delta</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">A</td>
<td align="right">0.10</td>
<td align="right">0.0355196</td>
<td align="right">0.0355196</td>
<td align="right">1.526948</td>
<td align="right">2</td>
<td align="right">0.59</td>
</tr>
<tr class="even">
<td align="left">A</td>
<td align="right">0.25</td>
<td align="right">0.0587524</td>
<td align="right">0.0587524</td>
<td align="right">1.673109</td>
<td align="right">2</td>
<td align="right">0.59</td>
</tr>
<tr class="odd">
<td align="left">A</td>
<td align="right">0.50</td>
<td align="right">0.0717438</td>
<td align="right">0.0717438</td>
<td align="right">1.758418</td>
<td align="right">2</td>
<td align="right">0.59</td>
</tr>
<tr class="even">
<td align="left">A</td>
<td align="right">0.75</td>
<td align="right">0.1240478</td>
<td align="right">0.1240478</td>
<td align="right">2.172950</td>
<td align="right">3</td>
<td align="right">0.59</td>
</tr>
<tr class="odd">
<td align="left">A</td>
<td align="right">0.90</td>
<td align="right">0.1687990</td>
<td align="right">0.1687990</td>
<td align="right">2.671229</td>
<td align="right">3</td>
<td align="right">0.59</td>
</tr>
<tr class="even">
<td align="left">A</td>
<td align="right">0.10</td>
<td align="right">0.0355196</td>
<td align="right">0.0530265</td>
<td align="right">1.500024</td>
<td align="right">2</td>
<td align="right">1.00</td>
</tr>
<tr class="odd">
<td align="left">A</td>
<td align="right">0.25</td>
<td align="right">0.0587524</td>
<td align="right">0.0587524</td>
<td align="right">1.521541</td>
<td align="right">2</td>
<td align="right">1.00</td>
</tr>
<tr class="even">
<td align="left">A</td>
<td align="right">0.50</td>
<td align="right">0.0717438</td>
<td align="right">0.0717438</td>
<td align="right">1.569649</td>
<td align="right">2</td>
<td align="right">1.00</td>
</tr>
<tr class="odd">
<td align="left">A</td>
<td align="right">0.75</td>
<td align="right">0.1240478</td>
<td align="right">0.1240478</td>
<td align="right">1.768204</td>
<td align="right">2</td>
<td align="right">1.00</td>
</tr>
<tr class="even">
<td align="left">A</td>
<td align="right">0.90</td>
<td align="right">0.1687990</td>
<td align="right">0.1687990</td>
<td align="right">1.961551</td>
<td align="right">2</td>
<td align="right">1.00</td>
</tr>
<tr class="odd">
<td align="left">A</td>
<td align="right">0.10</td>
<td align="right">0.0355196</td>
<td align="right">0.1060530</td>
<td align="right">1.500024</td>
<td align="right">2</td>
<td align="right">2.00</td>
</tr>
<tr class="even">
<td align="left">A</td>
<td align="right">0.25</td>
<td align="right">0.0587524</td>
<td align="right">0.1060530</td>
<td align="right">1.500024</td>
<td align="right">2</td>
<td align="right">2.00</td>
</tr>
<tr class="odd">
<td align="left">A</td>
<td align="right">0.50</td>
<td align="right">0.0717438</td>
<td align="right">0.1060530</td>
<td align="right">1.500024</td>
<td align="right">2</td>
<td align="right">2.00</td>
</tr>
<tr class="even">
<td align="left">A</td>
<td align="right">0.75</td>
<td align="right">0.1240478</td>
<td align="right">0.1240478</td>
<td align="right">1.533718</td>
<td align="right">2</td>
<td align="right">2.00</td>
</tr>
<tr class="odd">
<td align="left">A</td>
<td align="right">0.90</td>
<td align="right">0.1687990</td>
<td align="right">0.1687990</td>
<td align="right">1.616344</td>
<td align="right">2</td>
<td align="right">2.00</td>
</tr>
</tbody>
</table>
<p>The table summarises visually how many samples are needed for
different expected differences (in log2-scale) and different portions of
all proteins.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sampleSize</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">probs</span><span class="op">)</span> , y <span class="op">=</span> <span class="va">N</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">delta</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="QualityControlAndSampleSizeEstimation_files/figure-html/unnamed-chunk-3-1.png" alt="Estimated sample sizes for various FC levels and various quantiles of the standard deviation." width="700"><p class="caption">
Estimated sample sizes for various FC levels and various quantiles of
the standard deviation.
</p>
</div>
<p>It is also possible to get the statistics for each protein in each
group. The information includes group size, number of observations,
standard deviation, variance, mean.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stats</span><span class="op">$</span><span class="fu">stats</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 6 × 11</span></span></span>
<span><span class="co">##   protein_Id  peptide_Id group_ nrReplicates nrMeasured nrNAs      sd        var</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> 0EfVhX~0087 ITLb4x1q   A                 4          3     1 0.154   0.023<span style="text-decoration: underline;">6</span>    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> 0EfVhX~0087 ahQLlQY7   A                 4          4     0 0.062<span style="text-decoration: underline;">0</span>  0.003<span style="text-decoration: underline;">85</span>   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> 0EfVhX~0087 dJkdz7so   A                 4          2     2 0.182   0.033<span style="text-decoration: underline;">0</span>    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> 7cbcrd~5725 D5dQ4nKk   A                 4          4     0 0.050<span style="text-decoration: underline;">9</span>  0.002<span style="text-decoration: underline;">59</span>   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> 9VUkAq~4703 eIC06D7g   A                 4          4     0 0.094<span style="text-decoration: underline;">6</span>  0.008<span style="text-decoration: underline;">95</span>   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span> BEJI92~5282 HBkZvdhT   A                 4          2     2 0.003<span style="text-decoration: underline;">05</span> 0.000<span style="text-decoration: underline;">009</span>29</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 3 more variables: meanAbundance &lt;dbl&gt;, medianAbundance &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   interaction &lt;chr&gt;</span></span></span></code></pre>
<p>You can also estimate the sample size needed to perform differential
expression analysis for each protein, given the <code>power</code>,
<code>delta</code>, and <code>sig.level</code>. The next figure shows
the distribution of needed sample sizes for all proteins with a power of
0.8 at signifiance level 0.05 for a two fold change (delta = 1).</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">stats</span><span class="op">$</span><span class="fu">power_t_test</span><span class="op">(</span>delta <span class="op">=</span> <span class="fl">1</span>,power <span class="op">=</span> <span class="fl">0.8</span>, sig.level <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">group_</span> <span class="op">==</span> <span class="st">"A"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span>,<span class="va">protein_Id</span><span class="op">)</span></span>
<span><span class="fu">prolfqua</span><span class="fu">::</span><span class="fu"><a href="../reference/table_facade.html">table_facade</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">7</span>,<span class="op">]</span>, caption <span class="op">=</span> <span class="st">"Sample size for each protein"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Sample size for each protein</caption>
<colgroup>
<col width="8%">
<col width="7%">
<col width="5%">
<col width="9%">
<col width="7%">
<col width="4%">
<col width="7%">
<col width="7%">
<col width="10%">
<col width="11%">
<col width="8%">
<col width="4%">
<col width="6%">
<col width="2%">
</colgroup>
<thead><tr class="header">
<th align="left">protein_Id</th>
<th align="left">peptide_Id</th>
<th align="left">group_</th>
<th align="right">nrReplicates</th>
<th align="right">nrMeasured</th>
<th align="right">nrNAs</th>
<th align="right">sd</th>
<th align="right">var</th>
<th align="right">meanAbundance</th>
<th align="right">medianAbundance</th>
<th align="left">interaction</th>
<th align="right">delta</th>
<th align="right">N_exact</th>
<th align="right">N</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">0EfVhX~0087</td>
<td align="left">dJkdz7so</td>
<td align="left">A</td>
<td align="right">4</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">0.1816806</td>
<td align="right">0.0330078</td>
<td align="right">3.971469</td>
<td align="right">3.971469</td>
<td align="left">group_A</td>
<td align="right">1</td>
<td align="right">2.023422</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">HvIpHG~9079</td>
<td align="left">opjydeWJ</td>
<td align="left">A</td>
<td align="right">4</td>
<td align="right">3</td>
<td align="right">1</td>
<td align="right">0.2392614</td>
<td align="right">0.0572460</td>
<td align="right">4.094835</td>
<td align="right">3.997946</td>
<td align="left">group_A</td>
<td align="right">1</td>
<td align="right">2.344670</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">JcKVfU~9653</td>
<td align="left">9LMQBevj</td>
<td align="left">A</td>
<td align="right">4</td>
<td align="right">4</td>
<td align="right">0</td>
<td align="right">0.1871014</td>
<td align="right">0.0350069</td>
<td align="right">5.482917</td>
<td align="right">5.406550</td>
<td align="left">group_A</td>
<td align="right">1</td>
<td align="right">2.050429</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">0EfVhX~0087</td>
<td align="left">ITLb4x1q</td>
<td align="left">A</td>
<td align="right">4</td>
<td align="right">3</td>
<td align="right">1</td>
<td align="right">0.1535287</td>
<td align="right">0.0235710</td>
<td align="right">4.190351</td>
<td align="right">4.178250</td>
<td align="left">group_A</td>
<td align="right">1</td>
<td align="right">1.892113</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">0EfVhX~0087</td>
<td align="left">ahQLlQY7</td>
<td align="left">A</td>
<td align="right">4</td>
<td align="right">4</td>
<td align="right">0</td>
<td align="right">0.0620097</td>
<td align="right">0.0038452</td>
<td align="right">4.742744</td>
<td align="right">4.735435</td>
<td align="left">group_A</td>
<td align="right">1</td>
<td align="right">1.533666</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">7cbcrd~5725</td>
<td align="left">D5dQ4nKk</td>
<td align="left">A</td>
<td align="right">4</td>
<td align="right">4</td>
<td align="right">0</td>
<td align="right">0.0508679</td>
<td align="right">0.0025875</td>
<td align="right">4.956022</td>
<td align="right">4.964554</td>
<td align="left">group_A</td>
<td align="right">1</td>
<td align="right">1.500024</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">9VUkAq~4703</td>
<td align="left">eIC06D7g</td>
<td align="left">A</td>
<td align="right">4</td>
<td align="right">4</td>
<td align="right">0</td>
<td align="right">0.0945821</td>
<td align="right">0.0089458</td>
<td align="right">4.159728</td>
<td align="right">4.182873</td>
<td align="left">group_A</td>
<td align="right">1</td>
<td align="right">1.654299</td>
<td align="right">2</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">|&gt;</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">N</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">delta</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">xlim</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">100</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="QualityControlAndSampleSizeEstimation_files/figure-html/unnamed-chunk-4-1.png" alt="Distribution of the required sample sizes for two fold change thresholds for all the proteins." width="700"><p class="caption">
Distribution of the required sample sizes for two fold change thresholds
for all the proteins.
</p>
</div>
<p>The <code>prolfqua</code> package is described in <span class="citation">(Wolski et al. 2022)</span>.</p>
</div>
</div>
<div class="section level2">
<h2 id="session-info">Session Info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## R version 4.3.2 (2023-10-31)</span></span>
<span><span class="co">## Platform: aarch64-apple-darwin20 (64-bit)</span></span>
<span><span class="co">## Running under: macOS Sonoma 14.5</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRblas.0.dylib </span></span>
<span><span class="co">## LAPACK: /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.11.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## time zone: Europe/Zurich</span></span>
<span><span class="co">## tzcode source: internal</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##  [1] tidyr_1.3.1        plotly_4.10.4      sass_0.4.9         utf8_1.2.4        </span></span>
<span><span class="co">##  [5] generics_0.1.3     KernSmooth_2.23-22 lattice_0.22-5     stringi_1.8.3     </span></span>
<span><span class="co">##  [9] digest_0.6.35      magrittr_2.0.3     evaluate_0.23      grid_4.3.2        </span></span>
<span><span class="co">## [13] RColorBrewer_1.1-3 fastmap_1.1.1      Matrix_1.6-5       jsonlite_1.8.8    </span></span>
<span><span class="co">## [17] ggrepel_0.9.5      prolfqua_1.2.5     conflicted_1.2.0   gridExtra_2.3     </span></span>
<span><span class="co">## [21] mgcv_1.9-1         httr_1.4.7         purrr_1.0.2        fansi_1.0.6       </span></span>
<span><span class="co">## [25] viridisLite_0.4.2  scales_1.3.0       lazyeval_0.2.2     textshaping_0.3.7 </span></span>
<span><span class="co">## [29] jquerylib_0.1.4    cli_3.6.2          rlang_1.1.3        splines_4.3.2     </span></span>
<span><span class="co">## [33] munsell_0.5.1      withr_3.0.0        cachem_1.0.8       yaml_2.3.8        </span></span>
<span><span class="co">## [37] tools_4.3.2        memoise_2.0.1      dplyr_1.1.4        colorspace_2.1-0  </span></span>
<span><span class="co">## [41] ggplot2_3.5.1      forcats_1.0.0      vctrs_0.6.5        R6_2.5.1          </span></span>
<span><span class="co">## [45] lifecycle_1.0.4    stringr_1.5.1      fs_1.6.4           htmlwidgets_1.6.4 </span></span>
<span><span class="co">## [49] MASS_7.3-60.0.1    ragg_1.3.0         pkgconfig_2.0.3    desc_1.4.3        </span></span>
<span><span class="co">## [53] pkgdown_2.0.9      pillar_1.9.0       bslib_0.7.0        gtable_0.3.5      </span></span>
<span><span class="co">## [57] glue_1.7.0         data.table_1.15.4  Rcpp_1.0.12        systemfonts_1.0.6 </span></span>
<span><span class="co">## [61] highr_0.10         xfun_0.43          tibble_3.2.1       tidyselect_1.2.1  </span></span>
<span><span class="co">## [65] knitr_1.46         farver_2.1.1       nlme_3.1-164       htmltools_0.5.8.1 </span></span>
<span><span class="co">## [69] labeling_0.4.3     rmarkdown_2.26     pheatmap_1.0.12    compiler_4.3.2</span></span></code></pre>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Wolski2022.06.07.494524" class="csl-entry">
Wolski, Witold E., Paolo Nanni, Jonas Grossmann, Maria d’Errico, Ralph
Schlapbach, and Christian Panse. 2022. <span>“Prolfqua: A Comprehensive
<span class="nocase">R-package</span> for Proteomics Differential
Expression Analysis.”</span> <em>bioRxiv</em>. <a href="https://doi.org/10.1101/2022.06.07.494524" class="external-link">https://doi.org/10.1101/2022.06.07.494524</a>.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Witold Wolski.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
